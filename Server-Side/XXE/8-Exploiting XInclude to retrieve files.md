# Lab: Exploiting XInclude to retrieve files

>This lab has a "Check stock" feature that embeds the user input inside a server-side XML document that is subsequently parsed.

>Because you don't control the entire XML document you can't define a DTD to launch a classic XXE attack.

>To solve the lab, inject an XInclude statement to retrieve the contents of the /etc/passwd file.

### Observations
Vulnerable area: `POST /product/stock`

### XInclude attack payload
I got this directly from the portswigger reading associated with the XXE labs:
`<foo xmlns:xi="http://www.w3.org/2001/XInclude"><xi:include parse="text" href="file:///etc/passwd"/></foo>`

We can see that `POST /product/stock` has 2 params in the request body, this is likely the area of the request that we will attack.

### Solution
I set the value of the `productId` param equal to the above payload, and the response gave us the contents of the `/etc/passwd` file!