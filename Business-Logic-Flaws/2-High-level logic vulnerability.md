# Lab: High-level logic vulnerability

>This lab doesn't adequately validate user input. You can exploit a logic flaw in its purchasing workflow to buy items for an unintended price. To solve the lab, buy a "Lightweight l33t leather jacket".

>You can log in to your own account using the following credentials: wiener:peter

### Vulnerable area
`POST /cart HTTP/1.1`


I used burp to intercept the request when I change the quantity of product to purchase. I modified the request as below to order -1 jackets:

`productId=1&quantity=-2&redir=CART`

This gives the error that `Cart total price cannot be less than zero`...

### Solution
So the cart price can't be negative AND we need positive 1 for the quantity of jacket...
We can add 1 jacket to the cart (+$1337) and then add a negative quantity of other items to bring the total to >= $0 but less than $100

So I added negative 53 "Pet experience days" to my cart, which cost $24.88 each: `productId=2&quantity=-54&redir=CART`

Below you can see that I effectively purchased the jacket for $18.36

Lab solved!

<pre>Name	Price	Quantity	
Lightweight "l33t" Leather Jacket	$1337.00	1	
Pet Experience Days	$24.88	-53	
Total:	$18.36</pre>